<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>營北國中載具教室借用系統</title>
    <style>
        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            font-size: 125%;
            background-color: #e3f2fd; /* 淺藍色背景 */
            color: #1a237e; /* 深藍色文字 */
            text-align: center;
            padding: 20px;
        }
        h1 {
            color: #0d47a1; /* 深藍標題 */
            font-size: 2.5em;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: #ffffff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: 1px solid #90caf9; /* 淺藍邊框 */
        }
        .classroom {
            margin-top: 20px;
        }
        .classroom h2 {
            color: #1565c0; /* 中藍標題 */
            font-size: 2em;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        table, th, td {
            border: 1px solid #90caf9;
        }
        th, td {
            padding: 10px;
            text-align: center;
        }
        th {
            background-color: #42a5f5; /* 藍色標題背景 */
            color: white;
        }
        select, button {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            border: 1px solid #90caf9;
        }
        button {
            background-color: #1e88e5; /* 藍色按鈕 */
            color: white;
            cursor: pointer;
        }
        button:hover {
            background-color: #1565c0; /* 深藍按鈕 (hover) */
        }
        .navigation {
            margin: 20px 0;
            display: flex;
            justify-content: space-between;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>營北國中載具教室借用系統</h1>
        <div class="navigation">
            <button onclick="changeWeek(-1)">上一週</button>
            <span id="current-week">114年第1週</span>
            <button onclick="changeWeek(1)">下一週</button>
        </div>
        <div class="year-month-selector">
            <select id="year-selector" onchange="updateCalendar()">
                <option value="114">114年</option>
                <option value="115">115年</option>
            </select>
            <select id="month-selector" onchange="updateCalendar()">
                ${Array.from({ length: 12 }, (_, i) => <option value="${i + 1}">${i + 1}月</option>).join('')}
            </select>
            <button onclick="changeDate()">確定</button>
        </div>
        <div>
            <input type="file" id="file-input" accept=".txt" onchange="loadFile()">
            <button onclick="uploadFile()">上傳名單</button>
        </div>
        <div class="classroom" id="digital-classroom">
            <h2>數位教室</h2>
            <div id="digital-calendar"></div>
        </div>
        <div class="classroom" id="social-classroom">
            <h2>社會教室</h2>
            <div id="social-calendar"></div>
        </div>
    </div>

    <script>
        const weekDays = ['星期一', '星期二', '星期三', '星期四', '星期五', '星期六'];
        const periods = 8; // 每天8節課
        const maxPeople = 60; // 每個時段最多60人
        let currentWeek = 1;
        let currentYear = 114;
        let currentMonth = 1;

        // 假設有一個從外部匯入的名單
        let peopleList = Array.from({ length: maxPeople }, (_, i) => `學生${i + 1}`);

        function createTable(classroomId, classroomName) {
            const container = document.getElementById(`${classroomId}-calendar`);
            let table = '<table><thead><tr><th>時間</th>';

            const firstDay = new Date(`${currentYear + 1911}-${String(currentMonth).padStart(2, '0')}-01`);
            const firstDayOfWeek = (firstDay.getDay() + 6) % 7; // 以星期一為第一天
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - firstDayOfWeek);

            for (let i = 0; i < weekDays.length; i++) {
                const date = new Date(startDate);
                date.setDate(date.getDate() + i);
                const dateStr = `${String(date.getMonth() + 1).padStart(2, '0')}${String(date.getDate()).padStart(2, '0')}`;
                table += `<th>${weekDays[i]}<br>${dateStr}</th>`;
            }

            table += '</tr></thead><tbody>';

            for (let period = 1; period <= periods; period++) {
                table += `<tr><td>第${period}節</td>`;

                for (let day = 0; day < weekDays.length; day++) {
                    table += `<td>
                                <select>
                                    <option value="">選擇借用人</option>
                                    ${peopleList.map(person => `<option value="${person}">${person}</option>`).join('')}
                                </select>
                                <button onclick="disablePeriod('${classroomId}', ${day}, ${period})">不可借用</button>
                              </td>`;
                }

                table += '</tr>';
            }

            table += '</tbody></table>';
            container.innerHTML = table;
        }

        function disablePeriod(classroomId, day, period) {
            const cell = document.querySelector(`#${classroomId}-calendar table tbody tr:nth-child(${period}) td:nth-child(${day + 2})`);
            cell.innerHTML = '不可借用';
            cell.style.backgroundColor = '#90caf9';
        }

        function changeWeek(offset) {
            currentWeek += offset;
            if (currentWeek < 1) currentWeek = 1;
            document.getElementById('current-week').textContent = `${currentYear}年第${currentWeek}週`;
            createTable('digital', '數位教室');
            createTable('social', '社會教室');
        }

        function changeDate() {
            const year = document.getElementById('year-selector').value;
            const month = document.getElementById('month-selector').value;
            currentYear = parseInt(year);
            currentMonth = parseInt(month);
            alert(`切換至 ${year} 年 ${month} 月`);
            updateCalendar();
        }

        function updateCalendar() {
            createTable('digital', '數位教室');
            createTable('social', '社會教室');
        }

        function loadFile() {
            const fileInput = document.getElementById('file-input');
            const file = fileInput.files[0];
            const reader = new FileReader();
            reader.onload = function() {
                peopleList = reader.result.split('\n').filter(line => line.trim());
                alert('名單已讀取！');
                // 重新產生表格，更新名單
                createTable('digital', '數位教室');
                createTable('social', '社會教室');
            };
            reader.readAsText(file);
        }

        function uploadFile() {
            const fileInput = document.getElementById('file-input');
            fileInput.click();
        }

        // 初始化兩個教室的表格
        createTable('digital', '數位教室');
        createTable('social', '社會教室');
    </script>
</body>
</html>
